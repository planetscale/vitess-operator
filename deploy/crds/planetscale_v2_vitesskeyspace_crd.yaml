apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  name: vitesskeyspaces.planetscale.com
spec:
  group: planetscale.com
  names:
    kind: VitessKeyspace
    listKind: VitessKeyspaceList
    plural: vitesskeyspaces
    shortNames:
    - vtk
    singular: vitesskeyspace
  scope: Namespaced
  subresources:
    status: {}
  validation:
    openAPIV3Schema:
      properties:
        apiVersion:
          description: 'APIVersion defines the versioned schema of this representation
            of an object. Servers should convert recognized schemas to the latest
            internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/api-conventions.md#resources'
          type: string
        kind:
          description: 'Kind is a string value representing the REST resource this
            object represents. Servers may infer this from the endpoint the client
            submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/api-conventions.md#types-kinds'
          type: string
        metadata:
          type: object
        spec:
          properties:
            backupEngine:
              description: BackupEngine specifies the Vitess backup engine to use,
                either "builtin" or "xtrabackup".
              type: string
            backupLocations:
              description: BackupLocations are the backup locations defined in the
                VitessCluster.
              items:
                properties:
                  gcs:
                    description: GCS specifies a backup location in Google Cloud Storage.
                    properties:
                      authSecret:
                        description: 'AuthSecret is a reference to the Secret to use
                          for GCS authentication. If set, this must point to a file
                          in the format expected for the GOOGLE_APPLICATION_CREDENTIALS
                          environment variable. Default: Use the default credentials
                          of the Node.'
                        type: object
                      bucket:
                        description: Bucket is the name of the GCS bucket to use.
                        minLength: 1
                        type: string
                      keyPrefix:
                        description: KeyPrefix is an optional prefix added to all
                          object keys created by Vitess. This is only needed if the
                          same bucket is also used for something other than backups
                          for VitessClusters. Backups from different clusters, keyspaces,
                          or shards will automatically avoid colliding with each other
                          within a bucket, regardless of this setting.
                        maxLength: 256
                        pattern: ^[^\r\n]*$
                        type: string
                    required:
                    - bucket
                    type: object
                  name:
                    description: Name is used to refer to this backup location from
                      other parts of a VitessCluster object, such as in tablet pool
                      definitions. This name must be unique among all backup locations
                      defined in a given cluster. A backup location with an empty
                      name defines the default location used when a tablet pool does
                      not specify a backup location name.
                    maxLength: 25
                    pattern: ^[a-z0-9]([a-z0-9]*[a-z0-9])?$
                    type: string
                  s3:
                    description: S3 specifies a backup location in Amazon S3.
                    properties:
                      authSecret:
                        description: 'AuthSecret is a reference to the Secret to use
                          for S3 authentication. If set, this must point to a file
                          in the format expected for the `~/.aws/credentials` file.
                          Default: Use the default credentials of the Node.'
                        type: object
                      bucket:
                        description: Bucket is the name of the S3 bucket to use.
                        minLength: 1
                        type: string
                      keyPrefix:
                        description: KeyPrefix is an optional prefix added to all
                          object keys created by Vitess. This is only needed if the
                          same bucket is also used for something other than backups
                          for VitessClusters. Backups from different clusters, keyspaces,
                          or shards will automatically avoid colliding with each other
                          within a bucket, regardless of this setting.
                        maxLength: 256
                        pattern: ^[^\r\n]*$
                        type: string
                      region:
                        description: Region is the AWS region in which the bucket
                          is located.
                        minLength: 1
                        type: string
                    required:
                    - region
                    - bucket
                    type: object
                  volume:
                    description: Volume specifies a backup location as a Kubernetes
                      Volume Source to mount. This can be used, for example, to store
                      backups on an NFS mount, or on a shared host path for local
                      testing.
                    type: object
                type: object
              type: array
            globalLockserver:
              description: GlobalLockserver are the params to connect to the global
                lockserver.
              properties:
                address:
                  description: Address is the host:port of the lockserver client endpoint.
                  type: string
                implementation:
                  description: Implementation specifies which Vitess "topo" plugin
                    to use.
                  type: string
                rootPath:
                  description: RootPath is a path prefix for all lockserver data belonging
                    to a given Vitess cluster. Multiple Vitess clusters can share
                    a lockserver as long as they have unique root paths.
                  type: string
              required:
              - implementation
              - address
              - rootPath
              type: object
            imagePullPolicies:
              description: ImagePullPolicies are inherited from the VitessCluster
                spec.
              properties:
                mysqld:
                  description: Mysqld is the container image pull policy to use for
                    mysqld.
                  type: string
                mysqldExporter:
                  description: MysqldExporter is the container image pull policy to
                    use for mysqld-exporter.
                  type: string
                vtbackup:
                  description: Vtbackup is the container image pull policy to use
                    for Vitess Backup jobs.
                  type: string
                vtctld:
                  description: Vtctld is the container image pull policy to use for
                    Vitess Dashboard instances.
                  type: string
                vtgate:
                  description: Vtgate is the container image pull policy to use for
                    Vitess Gateway instances.
                  type: string
                vttablet:
                  description: Vttablet is the container image pull policy to use
                    for Vitess Tablet instances.
                  type: string
              type: object
            images:
              description: Images are not customizable by users at the keyspace level
                because version skew across the cluster is discouraged except during
                rolling updates, in which case this field is automatically managed
                by the VitessCluster controller that owns this VitessKeyspace.
              properties:
                mysqld:
                  description: Mysqld specifies the container image to use for mysqld,
                    as well as declaring which MySQL flavor setting in Vitess the
                    image is compatible with. Only one flavor image may be provided
                    at a time. mysqld running alongside each tablet.
                  properties:
                    mariadb103Compatible:
                      description: Mariadb103Compatible is a container image (including
                        version tag) for mysqld that's compatible with the Vitess
                        "MariaDB103" flavor setting.
                      type: string
                    mariadbCompatible:
                      description: MariadbCompatible is a container image (including
                        version tag) for mysqld that's compatible with the Vitess
                        "MariaDB" flavor setting.
                      type: string
                    mysql56Compatible:
                      description: Mysql56Compatible is a container image (including
                        version tag) for mysqld that's compatible with the Vitess
                        "MySQL56" flavor setting.
                      type: string
                    mysql80Compatible:
                      description: Mysql80Compatible is a container image (including
                        version tag) for mysqld that's compatible with the Vitess
                        "MySQL80" flavor setting.
                      type: string
                  type: object
                mysqldExporter:
                  description: MysqldExporter specifies the container image for mysqld-exporter.
                  type: string
                vtbackup:
                  description: Vtbackup is the container image (including version
                    tag) to use for Vitess Backup jobs.
                  type: string
                vttablet:
                  description: Vttablet is the container image (including version
                    tag) to use for Vitess Tablet instances.
                  type: string
              type: object
            name:
              description: 'Name is the keyspace name as it should be provided to
                Vitess. Note that this is different from the VitessKeyspace object''s
                metadata.name, which is generated by the operator.  WARNING: DO NOT
                change the name of a keyspace that was already deployed. Keyspaces
                cannot be renamed, so this will be interpreted as an instruction to
                delete the old keyspace and create a new one.'
              maxLength: 25
              minLength: 1
              pattern: ^[a-z0-9]([a-z0-9]*[a-z0-9])?$
              type: string
            partitionings:
              description: Partitionings specify how to divide the keyspace up into
                shards by defining the range of keyspace IDs that each shard contains.
                For example, you might divide the keyspace into N equal-sized key
                ranges.  Note that this is distinct from defining how each row maps
                to a keyspace ID, which is done in the VSchema. Partitioning is purely
                an operational concern (scaling the infrastructure), while VSchema
                is an application-level concern (modeling relationships between data).
                This separation of concerns allows resharding to occur generically
                at the infrastructure level without any knowledge of the data model.  Each
                partitioning must define a set of shards that fully covers the space
                of all possible keyspace IDs; there can be no gaps between ranges.
                There's usually only one partitioning present at a time, but during
                resharding, it's necessary to launch the destination shards alongside
                the source shards. When the resharding is complete, the old partitioning
                can be removed, which will turn down (undeploy) any unneeded shards.  If
                only some shards are being split or joined during resharding, the
                shards that aren't changing must be specified in both partitionings,
                although the common shards will be shared (only deployed once). If
                the per-shard configuration differs, the configuration in the latter
                partitioning (in the order listed in this field) will be used. For
                this reason, it's recommended to add new partitionings at the end,
                and only remove partitionings from the beginning.  This field is required.
                An unsharded keyspace may be specified as a partitioning into 1 part.
              items:
                properties:
                  custom:
                    description: Custom partitioning lets you explicitly specify the
                      key range of every shard, in case you don't want them to be
                      divided equally.
                    properties:
                      shards:
                        description: Shards is a list of explicit shard specifications.
                          +patchMergeKey=keyRange +patchStrategy=merge
                        items:
                          properties:
                            databaseInitScriptSecret:
                              description: DatabaseInitScriptSecret specifies the
                                init_db.sql script file to use for this shard. This
                                SQL script file is executed immediately after bootstrapping
                                an empty database to set up initial tables and other
                                MySQL-level entities needed by Vitess.
                              type: object
                            keyRange:
                              description: 'KeyRange is the range of keys that this
                                shard serves.  WARNING: DO NOT change the key range
                                of a shard after deploying.          That''s effectively
                                deleting the old shard and adding a new one,          which
                                can lead to downtime or data loss. Instead, add an
                                additional          partitioning with the desired
                                set of shards, perform a resharding          migration,
                                and then remove the old partitioning.'
                              properties:
                                end:
                                  description: End is a lowercase hexadecimal string
                                    representation of an arbitrary-length sequence
                                    of bytes. If End is the empty string, the key
                                    range is unbounded at the top. If End is not empty,
                                    the bytes of a keyspace ID must compare strictly
                                    less than End in lexicographical order to be in
                                    the range.
                                  pattern: ^([0-9a-f][0-9a-f])*$
                                  type: string
                                start:
                                  description: Start is a lowercase hexadecimal string
                                    representation of an arbitrary-length sequence
                                    of bytes. If Start is the empty string, the key
                                    range is unbounded at the bottom. If Start is
                                    not empty, the bytes of a keyspace ID must compare
                                    greater than or equal to Start in lexicographical
                                    order to be in the range.
                                  pattern: ^([0-9a-f][0-9a-f])*$
                                  type: string
                              type: object
                            replication:
                              description: Replication configures Vitess replication
                                settings for the shard.
                              properties:
                                enforceSemiSync:
                                  description: 'EnforceSemiSync means Vitess will
                                    configure MySQL to require semi-sync acknowledgement
                                    of all transactions while forbidding fallback
                                    to asynchronous replication under any circumstance.  Note
                                    that this is different from merely *enabling*
                                    semi-sync, which in its default configuration
                                    allows fallback to asynchronous replication if
                                    no replicas are connected or if they don''t respond
                                    after a few seconds. Enforced semi-sync is a mode
                                    that prefers master unavailability when durability
                                    cannot be ensured, rather than risking the loss
                                    of data that was already reported to clients as
                                    committed.  WARNING: Do not enable this if the
                                    shard has fewer than 3 master-eligible replicas,
                                    as that may lead to master unavailability during
                                    routine maintenance.  Default: Semi-sync is not
                                    enforced.'
                                  type: boolean
                              type: object
                            tabletPools:
                              description: TabletPools specify groups of tablets in
                                a given cell with a certain tablet type and a shared
                                configuration template.  There must be at most one
                                pool in this list for each (cell,type) pair. Each
                                shard must have at least one "replica" pool (in at
                                least one cell) in order to be able to serve. +patchMergeKey=type
                                +patchStrategy=merge +listType=map +listMapKey=type
                                +listMapKey=cell
                              items:
                                properties:
                                  affinity:
                                    description: 'Affinity allows you to set rules
                                      that constrain the scheduling of your vttablet
                                      pods. Affinity rules will affect all underlying
                                      tablets in the specified tablet pool the same
                                      way. WARNING: These affinity rules will override
                                      all default affinities that we set; in turn,
                                      we can''t guarantee optimal scheduling of your
                                      pods if you choose to set this field.'
                                    type: object
                                  annotations:
                                    additionalProperties:
                                      type: string
                                    description: Annotations can optionally be used
                                      to attach custom annotations to Pods created
                                      for this component.
                                    type: object
                                  backupLocationName:
                                    description: 'BackupLocationName is the name of
                                      the backup location to use for this tablet pool.
                                      It must match the name of one of the backup
                                      locations defined in the VitessCluster. Default:
                                      Use the backup location whose name is empty.'
                                    type: string
                                  cell:
                                    description: Cell is the name of the Vitess cell
                                      in which to deploy this pool.
                                    minLength: 1
                                    pattern: ^[a-z0-9]([a-z0-9]*[a-z0-9])?$
                                    type: string
                                  dataVolumeClaimTemplate:
                                    description: 'DataVolumeClaimTemplate configures
                                      the PersistentVolumeClaims that will be created
                                      for each tablet to store its database files.
                                      This field is required for local MySQL, but
                                      should be omitted in the case of externally
                                      managed MySQL.  IMPORTANT: If your Kubernetes
                                      cluster is multi-zone, you must set a storageClassName
                                      here for a StorageClass that''s configured to
                                      only provision volumes in the same zone as this
                                      tablet pool.'
                                    type: object
                                  externalDatastore:
                                    description: ExternalDatastore provides information
                                      for an externally managed MySQL. You must specify
                                      either Mysqld or ExternalDatastore, but not
                                      both.
                                    properties:
                                      credentialsSecret:
                                        description: 'CredentialsSecret should link
                                          to a JSON credentials file used to connect
                                          to the externally managed MySQL endpoint.
                                          The credentials file is understood and parsed
                                          by Vitess and must be in the format: {   "username":
                                          [     "password"   ] } Vitess always uses
                                          the first password in the password array.'
                                        type: object
                                      database:
                                        description: Database is the name of the database.
                                        type: string
                                      host:
                                        description: Host is the endpoint string to
                                          an externally managed MySQL, without any
                                          port.
                                        type: string
                                      port:
                                        description: Port specifies the port for the
                                          externally managed MySQL endpoint.
                                        format: int32
                                        maximum: 65535
                                        minimum: 1
                                        type: integer
                                      serverCACertSecret:
                                        description: ServerCACertSecret should link
                                          to a certificate authority file if one is
                                          required by your externally managed MySQL
                                          endpoint.
                                        type: object
                                      user:
                                        description: User is a provided database user
                                          from an externally managed MySQL that Vitess
                                          can use to carry out necessary actions.  Password
                                          for this user must be supplied in the CredentialsSecret.
                                        type: string
                                    required:
                                    - user
                                    - host
                                    - port
                                    - database
                                    - credentialsSecret
                                    type: object
                                  extraEnv:
                                    description: ExtraEnv can optionally be used to
                                      override default environment variables set by
                                      the operator, or pass additional environment
                                      variables. These values are applied to both
                                      the vttablet and mysqld containers.
                                    items:
                                      type: object
                                    type: array
                                  extraVolumeMounts:
                                    description: ExtraVolumeMounts can optionally
                                      be used to override default Pod volumeMounts
                                      defined by the operator, or specify additional
                                      mounts. Typically, these are used to mount volumes
                                      defined through extraVolumes. These values are
                                      applied to both the vttablet and mysqld containers.
                                    items:
                                      type: object
                                    type: array
                                  extraVolumes:
                                    description: ExtraVolumes can optionally be used
                                      to override default Pod volumes defined by the
                                      operator, or provide additional volumes to the
                                      Pod. Note that when adding a new volume, you
                                      should usually also add a volumeMount to specify
                                      where in each container's filesystem the volume
                                      should be mounted. These volumes are available
                                      to be mounted by both vttablet and mysqld.
                                    items:
                                      type: object
                                    type: array
                                  mysqld:
                                    description: Mysqld configures a local MySQL running
                                      inside each tablet Pod. You must specify either
                                      Mysqld or ExternalDatastore, but not both.
                                    properties:
                                      configOverrides:
                                        description: ConfigOverrides can optionally
                                          be used to provide a my.cnf snippet to override
                                          default my.cnf values (included with Vitess)
                                          for this particular MySQL instance.
                                        type: string
                                      resources:
                                        description: Resources specify the compute
                                          resources to allocate for just the MySQL
                                          process (the underlying local datastore).
                                          This field is required.
                                        type: object
                                    required:
                                    - resources
                                    type: object
                                  replicas:
                                    description: Replicas is the number of tablets
                                      to deploy in this pool. This field is required,
                                      although it may be set to 0, which will scale
                                      the pool down to 0 tablets.
                                    format: int32
                                    minimum: 0
                                    type: integer
                                  type:
                                    description: Type is the type of tablet contained
                                      in this tablet pool. The allowed types are "replica"
                                      for master-eligible replicas that serve transactional
                                      (OLTP) workloads; and "rdonly" for master-ineligible
                                      replicas (can never be promoted to master) that
                                      serve batch/analytical (OLAP) workloads.
                                    enum:
                                    - replica
                                    - rdonly
                                    - externalmaster
                                    - externalreplica
                                    - externalrdonly
                                    type: string
                                  vttablet:
                                    description: Vttablet configures the vttablet
                                      server within each tablet.
                                    properties:
                                      extraFlags:
                                        additionalProperties:
                                          type: string
                                        description: 'ExtraFlags can optionally be
                                          used to override default flags set by the
                                          operator, or pass additional flags to vttablet.
                                          All entries must be key-value string pairs
                                          of the form "flag": "value". The flag name
                                          should not have any prefix (just "flag",
                                          not "-flag"). To set a boolean flag, set
                                          the string value to either "true" or "false".'
                                        type: object
                                      resources:
                                        description: Resources specify the compute
                                          resources to allocate for just the vttablet
                                          process (the Vitess query server that sits
                                          in front of MySQL). This field is required.
                                        type: object
                                    required:
                                    - resources
                                    type: object
                                required:
                                - cell
                                - type
                                - replicas
                                - vttablet
                                type: object
                              type: array
                          required:
                          - keyRange
                          type: object
                        type: array
                    required:
                    - shards
                    type: object
                  equal:
                    description: Equal partitioning splits the keyspace into some
                      number of equal parts, assuming that the keyspace IDs are uniformly
                      distributed, for example because they're generated by a hash
                      vindex.
                    properties:
                      parts:
                        description: 'Parts is the number of equal parts to split
                          the keyspace into. If you need shards that are not equal-sized,
                          use custom partitioning instead.  Note that if the number
                          of parts is not a power of 2, the key ranges will only be
                          roughly equal in size.  WARNING: DO NOT change the number
                          of parts in a partitioning after deploying.          That''s
                          effectively deleting the old partitioning and adding a new
                          one,          which can lead to downtime or data loss. Instead,
                          add an additional          partitioning with the desired
                          number of parts, perform a resharding          migration,
                          and then remove the old partitioning.'
                        format: int32
                        minimum: 1
                        type: integer
                      shardTemplate:
                        description: ShardTemplate is the configuration used for each
                          equal-sized shard. If you need shards that don't all share
                          the same configuration, use custom partitioning instead.
                        properties:
                          databaseInitScriptSecret:
                            description: DatabaseInitScriptSecret specifies the init_db.sql
                              script file to use for this shard. This SQL script file
                              is executed immediately after bootstrapping an empty
                              database to set up initial tables and other MySQL-level
                              entities needed by Vitess.
                            type: object
                          replication:
                            description: Replication configures Vitess replication
                              settings for the shard.
                            properties:
                              enforceSemiSync:
                                description: 'EnforceSemiSync means Vitess will configure
                                  MySQL to require semi-sync acknowledgement of all
                                  transactions while forbidding fallback to asynchronous
                                  replication under any circumstance.  Note that this
                                  is different from merely *enabling* semi-sync, which
                                  in its default configuration allows fallback to
                                  asynchronous replication if no replicas are connected
                                  or if they don''t respond after a few seconds. Enforced
                                  semi-sync is a mode that prefers master unavailability
                                  when durability cannot be ensured, rather than risking
                                  the loss of data that was already reported to clients
                                  as committed.  WARNING: Do not enable this if the
                                  shard has fewer than 3 master-eligible replicas,
                                  as that may lead to master unavailability during
                                  routine maintenance.  Default: Semi-sync is not
                                  enforced.'
                                type: boolean
                            type: object
                          tabletPools:
                            description: TabletPools specify groups of tablets in
                              a given cell with a certain tablet type and a shared
                              configuration template.  There must be at most one pool
                              in this list for each (cell,type) pair. Each shard must
                              have at least one "replica" pool (in at least one cell)
                              in order to be able to serve. +patchMergeKey=type +patchStrategy=merge
                              +listType=map +listMapKey=type +listMapKey=cell
                            items:
                              properties:
                                affinity:
                                  description: 'Affinity allows you to set rules that
                                    constrain the scheduling of your vttablet pods.
                                    Affinity rules will affect all underlying tablets
                                    in the specified tablet pool the same way. WARNING:
                                    These affinity rules will override all default
                                    affinities that we set; in turn, we can''t guarantee
                                    optimal scheduling of your pods if you choose
                                    to set this field.'
                                  type: object
                                annotations:
                                  additionalProperties:
                                    type: string
                                  description: Annotations can optionally be used
                                    to attach custom annotations to Pods created for
                                    this component.
                                  type: object
                                backupLocationName:
                                  description: 'BackupLocationName is the name of
                                    the backup location to use for this tablet pool.
                                    It must match the name of one of the backup locations
                                    defined in the VitessCluster. Default: Use the
                                    backup location whose name is empty.'
                                  type: string
                                cell:
                                  description: Cell is the name of the Vitess cell
                                    in which to deploy this pool.
                                  minLength: 1
                                  pattern: ^[a-z0-9]([a-z0-9]*[a-z0-9])?$
                                  type: string
                                dataVolumeClaimTemplate:
                                  description: 'DataVolumeClaimTemplate configures
                                    the PersistentVolumeClaims that will be created
                                    for each tablet to store its database files. This
                                    field is required for local MySQL, but should
                                    be omitted in the case of externally managed MySQL.  IMPORTANT:
                                    If your Kubernetes cluster is multi-zone, you
                                    must set a storageClassName here for a StorageClass
                                    that''s configured to only provision volumes in
                                    the same zone as this tablet pool.'
                                  type: object
                                externalDatastore:
                                  description: ExternalDatastore provides information
                                    for an externally managed MySQL. You must specify
                                    either Mysqld or ExternalDatastore, but not both.
                                  properties:
                                    credentialsSecret:
                                      description: 'CredentialsSecret should link
                                        to a JSON credentials file used to connect
                                        to the externally managed MySQL endpoint.
                                        The credentials file is understood and parsed
                                        by Vitess and must be in the format: {   "username":
                                        [     "password"   ] } Vitess always uses
                                        the first password in the password array.'
                                      type: object
                                    database:
                                      description: Database is the name of the database.
                                      type: string
                                    host:
                                      description: Host is the endpoint string to
                                        an externally managed MySQL, without any port.
                                      type: string
                                    port:
                                      description: Port specifies the port for the
                                        externally managed MySQL endpoint.
                                      format: int32
                                      maximum: 65535
                                      minimum: 1
                                      type: integer
                                    serverCACertSecret:
                                      description: ServerCACertSecret should link
                                        to a certificate authority file if one is
                                        required by your externally managed MySQL
                                        endpoint.
                                      type: object
                                    user:
                                      description: User is a provided database user
                                        from an externally managed MySQL that Vitess
                                        can use to carry out necessary actions.  Password
                                        for this user must be supplied in the CredentialsSecret.
                                      type: string
                                  required:
                                  - user
                                  - host
                                  - port
                                  - database
                                  - credentialsSecret
                                  type: object
                                extraEnv:
                                  description: ExtraEnv can optionally be used to
                                    override default environment variables set by
                                    the operator, or pass additional environment variables.
                                    These values are applied to both the vttablet
                                    and mysqld containers.
                                  items:
                                    type: object
                                  type: array
                                extraVolumeMounts:
                                  description: ExtraVolumeMounts can optionally be
                                    used to override default Pod volumeMounts defined
                                    by the operator, or specify additional mounts.
                                    Typically, these are used to mount volumes defined
                                    through extraVolumes. These values are applied
                                    to both the vttablet and mysqld containers.
                                  items:
                                    type: object
                                  type: array
                                extraVolumes:
                                  description: ExtraVolumes can optionally be used
                                    to override default Pod volumes defined by the
                                    operator, or provide additional volumes to the
                                    Pod. Note that when adding a new volume, you should
                                    usually also add a volumeMount to specify where
                                    in each container's filesystem the volume should
                                    be mounted. These volumes are available to be
                                    mounted by both vttablet and mysqld.
                                  items:
                                    type: object
                                  type: array
                                mysqld:
                                  description: Mysqld configures a local MySQL running
                                    inside each tablet Pod. You must specify either
                                    Mysqld or ExternalDatastore, but not both.
                                  properties:
                                    configOverrides:
                                      description: ConfigOverrides can optionally
                                        be used to provide a my.cnf snippet to override
                                        default my.cnf values (included with Vitess)
                                        for this particular MySQL instance.
                                      type: string
                                    resources:
                                      description: Resources specify the compute resources
                                        to allocate for just the MySQL process (the
                                        underlying local datastore). This field is
                                        required.
                                      type: object
                                  required:
                                  - resources
                                  type: object
                                replicas:
                                  description: Replicas is the number of tablets to
                                    deploy in this pool. This field is required, although
                                    it may be set to 0, which will scale the pool
                                    down to 0 tablets.
                                  format: int32
                                  minimum: 0
                                  type: integer
                                type:
                                  description: Type is the type of tablet contained
                                    in this tablet pool. The allowed types are "replica"
                                    for master-eligible replicas that serve transactional
                                    (OLTP) workloads; and "rdonly" for master-ineligible
                                    replicas (can never be promoted to master) that
                                    serve batch/analytical (OLAP) workloads.
                                  enum:
                                  - replica
                                  - rdonly
                                  - externalmaster
                                  - externalreplica
                                  - externalrdonly
                                  type: string
                                vttablet:
                                  description: Vttablet configures the vttablet server
                                    within each tablet.
                                  properties:
                                    extraFlags:
                                      additionalProperties:
                                        type: string
                                      description: 'ExtraFlags can optionally be used
                                        to override default flags set by the operator,
                                        or pass additional flags to vttablet. All
                                        entries must be key-value string pairs of
                                        the form "flag": "value". The flag name should
                                        not have any prefix (just "flag", not "-flag").
                                        To set a boolean flag, set the string value
                                        to either "true" or "false".'
                                      type: object
                                    resources:
                                      description: Resources specify the compute resources
                                        to allocate for just the vttablet process
                                        (the Vitess query server that sits in front
                                        of MySQL). This field is required.
                                      type: object
                                  required:
                                  - resources
                                  type: object
                              required:
                              - cell
                              - type
                              - replicas
                              - vttablet
                              type: object
                            type: array
                        type: object
                    required:
                    - parts
                    type: object
                type: object
              maxItems: 2
              minItems: 1
              type: array
            turndownPolicy:
              description: 'TurndownPolicy specifies what should happen if this keyspace
                is ever removed from the VitessCluster spec. By default, removing
                a keyspace entry from the VitessCluster spec will NOT actually turn
                down the deployed resources, unless it can be verified that the keyspace
                was previously set to have 0 total desired tablets across all shards.  With
                this default policy (RequireIdle), before removing the keyspace entry
                from the spec, you must first edit the keyspace entry to remove all
                tablet pools from all shards, and wait for that change to roll out.
                If a keyspace entry is removed too soon, the keyspace resources will
                remain deployed indefinitely, and the keyspace will be listed in the
                orphanedKeyspaces field of VitessCluster status.  This is a safety
                mechanism to prevent accidental edits to the cluster object from having
                immediate, destructive consequences. If the cluster spec is only ever
                edited by automation whose edits you trust to be safe, you can set
                the policy to Immediate to skip these checks.  Default: RequireIdle'
              enum:
              - RequireIdle
              - Immediate
              type: string
            zoneMap:
              additionalProperties:
                type: string
              description: ZoneMap is a map from Vitess cell name to zone (failure
                domain) name for all cells defined in the VitessCluster.
              type: object
          required:
          - name
          - partitionings
          - globalLockserver
          - zoneMap
          type: object
        status:
          properties:
            idle:
              description: Idle is a condition indicating whether the keyspace can
                be turned down. If Idle is True, the keyspace is not deployed in any
                cells, so it should be safe to turn down the keyspace.
              type: string
            observedGeneration:
              description: The generation observed by the controller.
              format: int64
              type: integer
            orphanedShards:
              additionalProperties:
                properties:
                  message:
                    description: Message is a human-readable explanation for why the
                      object is orphaned.
                    type: string
                  reason:
                    description: Reason is a CamelCase token for programmatic reasoning
                      about why the object is orphaned.
                    type: string
                required:
                - reason
                - message
                type: object
              description: OrphanedShards is a list of unwanted shards that could
                not be turned down.
              type: object
            shards:
              additionalProperties:
                properties:
                  cells:
                    description: Cells is a list of cells in which any tablets for
                      this shard are deployed.
                    items:
                      type: string
                    type: array
                  desiredTablets:
                    description: DesiredTablets is the number of desired tablets.
                      This is computed from information that's already available in
                      the spec, but clients should use this value instead of trying
                      to compute shard partitionings on their own.
                    format: int32
                    type: integer
                  hasMaster:
                    description: HasMaster is a condition indicating whether the Vitess
                      topology reflects a master for this shard.
                    type: string
                  pendingChanges:
                    description: PendingChanges describes changes to the shard that
                      will be applied the next time a rolling update allows.
                    type: string
                  readyTablets:
                    description: ReadyTablets is the number of desired tablets that
                      are Ready.
                    format: int32
                    type: integer
                  tablets:
                    description: Tablets is the number of observed tablets. This could
                      be higher or lower than desiredTablets if the state has not
                      yet converged.
                    format: int32
                    type: integer
                  updatedTablets:
                    description: UpdatedTablets is the number of desired tablets that
                      are up-to-date (have no pending changes).
                    format: int32
                    type: integer
                type: object
              description: Shards is a summary of the status of all desired shards.
              type: object
          type: object
  version: v2
  versions:
  - name: v2
    served: true
    storage: true
